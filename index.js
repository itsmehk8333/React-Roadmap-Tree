var json_data = {
   
        
            "name": "React roadmap",
            "free": true,
            "type": "levelOne",
            "description": "Interactive authoring tools",
            "children": [{
                "name": "Beginner",
                "free": true,
                "type": "levelTwo",
                "children": [
                    {
                        "name": "Learn about JSX",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Learn about React Components",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "State in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": " Props in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Lists and Keys in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Life Cycle Methods in React",
                        "free": true,
                        "type": "levelThree",
                    }

                ]
            },
            {
                "name": "Intermediate",
                "free": true,
                "type": "levelTwo",
                "children": [
                    {
                        "name": "Styling in React",
                        "free": true,
                        "type": "levelThree",
                        "children": [
                            {
                                "name": "TailwindCSS",
                                "free": true,
                                "type": "levelFour",
                            },
                            {
                                "name": "react-bootstrap",
                                "free": true,
                                "type": "levelFour",
                            },
                            {
                                "name": "MUI",
                                "free": true,
                                "type": "levelFour",
                            },
                            {
                                "name": "ChakraUI",
                                "free": true,
                                "type": "levelFour",
                            }
                        ]
                    },
                    {
                        "name": "Form Handling in React",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "react-hook-form",
                                "free": true,
                                "type": "levelFour",
                            }
                        ]
                    },
                    {
                        "name": "Reconciliation Process in React",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "Virtual DOM",
                                "free": true,
                                "type": "levelFour",
                            }
                        ]
                    },
                    {
                        "name": "Data Handling in React",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "Axios",
                                "free": true,
                                "type": "levelFour", 
                            },
                        ]

                    },
                    {
                        "name": "React Hooks",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "Use State",
                                "free": true,
                                "type": "levelFour", 
                            },
                            {
                                "name": "Use Effect",
                                "free": true,
                                "type": "levelFour", 
                            },
                            {
                                "name": "Use Ref",
                                "free": true,
                                "type": "levelFour", 
                            },
                            {
                                "name": "Use Memo",
                                "free": true,
                                "type": "levelFour", 
                            },
                            {
                                "name": "Use Callback",
                                "free": true,
                                "type": "levelFour", 
                            },
                        ]
                    },
                    {
                        "name": "Custom React Hooks",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Context in React",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "Use Context Hook",
                                "free": true,
                                "type": "levelFour", 
                            }
                        ]
                    }


                ]
            },
            {
                "name": "Advance",
                "free": true,
                "type": "levelTwo",
                "children": [
                    {
                        "name": "Lazy Loading in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Portals in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Routing in React",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "React Router",
                                "free": true,
                                "type": "levelFour", 
                            },
                        ]
                    },
                    {
                        "name": "State Management in React",
                        "free": true,
                        "type": "levelThree",
                        "children":[
                            {
                                "name": "Redux",
                                "free": true,
                                "type": "levelFour", 
                            },
                            {
                                "name": "Redux Toolkit",
                                "free": true,
                                "type": "levelFour", 
                            },
                            {
                                "name": "Mobx",
                                "free": true,
                                "type": "levelFour", 
                            }
                        ]
                    },
                    {
                        "name": "Theming in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Patterns in React",
                        "free": true,
                        "type": "levelThree",
                    },
                    {
                        "name": "Anti-Patterns in React",
                        "free": true,
                        "type": "levelThree",
                    }
                ]
            }
            ]
            // "children": [
            //     {
            //         "name": " Internal Working Packages",
            //         "free": true,
            //         "type": "levelTwo",
            //         "children": [

            //             {
            //                 "name": "webpack",
            //                 "free": true,
            //                 "type": "levelThree",
            //             },
            //             {
            //                 "name": "babel",
            //                 "free": true,
            //                 "type": "levelThree",
            //             }

            //         ]
            //     },
            //     {
            //         "name": "React basics",
            //         "free": true,
            //         "type": "levelTwo",
            //         "children": [
            //             {
            //                 "name": "React Life Cycle",
            //                 "free": true,
            //                 "type": "levelThree",
            //             },
            //             {
            //                 "name": "How react work ?",
            //                 "free": true,
            //                 "type": "levelThree",
            //             },
            //             {
            //                 "name": "Jsx syntax",
            //                 "free": true,
            //                 "type": "levelThree",
            //             },
            //             {
            //                 "name": "Styling in jsx",
            //                 "free": true,
            //                 "type": "levelThree",
            //             },

            //         ]
            //     },
            //     {
            //         "name": "Components",
            //         "free": true,
            //         "type": "levelTwo",
            //         "children": [
            //             {
            //                 "name": "Class components",
            //                 "free": true,
            //                 "type": "levelThree",
            //                 "children": [
            //                     {
            //                         "name": "Not suggesting after react 16 update !!!",
            //                         "type":"levelFour",
            //                     }
            //                 ]
            //             },
            //             {
            //                 "name": "Functional Components",
            //                 "free": true,
            //                 "type": "levelThree",
            //                 "children": [
            //                     {
            //                         "name": "Props Passing",
            //                         "free": true,
            //                         "type":"levelFour",
            //                     },
            //                     {
            //                         "name": "Hooks",
            //                         "free": true,
            //                         "type":"levelFour",
            //                         "children": [
            //                             {
            //                                 "name": "Basic Hooks",
            //                                 "free": true,
            //                                 "type":"levelFive",
            //                                 "children": [
            //                                     {
            //                                         "name": "Use State",
            //                                         "free": true,
            //                                     },
            //                                     {
            //                                         "name": "Use Effect",
            //                                         "free": true,
            //                                     },
            //                                     {
            //                                         "name": "Use Ref",
            //                                         "free": true,
            //                                     }
            //                                 ]
            //                             },
            //                             {
            //                                 "name": "Intermediate Hooks",
            //                                 "free": true,
            //                                 "type":"levelFive",
            //                                 "children": [
            //                                     {
            //                                         "name": "Use Memo",
            //                                         "free": true,
            //                                     },
            //                                     {
            //                                         "name": "Use Reducer",
            //                                         "free": true,
            //                                     },
            //                                     {
            //                                         "name": "Use Context",
            //                                         "free": true,
            //                                     },
            //                                     {
            //                                         "name": "Use Callback",
            //                                         "free": true,
            //                                     }
            //                                 ]
            //                             },
            //                             {
            //                                 "name": "Advanced Hooks",
            //                                 "free": true,
            //                                 "type":"levelFive",
            //                             },
            //                             {
            //                                 "name": "Custom Hooks",
            //                                 "free": true,
            //                                 "type":"levelFive",
            //                             }
            //                         ]
            //                     },
            //                 ]
            //             }
            //         ]
            //     },
            //     {
            //         "name": "React Router",
            //         "free": true,
            //         "type": "levelTwo",
            //         "description": "better to use above react v6.",
            //         "children": [
            //             {
            //                 "name": "How routindg works ?",
            //                 "free": true,
            //                 "type": "levelThree",
            //             },
            //             {
            //                 "name":"Routing Hooks",
            //                 "free": true,
            //                 "type": "levelThree",
            //                 "children":[
            //                     {
            //                         "name":"Use Params",
            //                         "free":true,
            //                         "type": "levelFour",
            //                     },
            //                     {
            //                         "name":"Use Navigate",
            //                         "free":true,
            //                         "type":"levelFour"
            //                     },
            //                     {
            //                         "name":"Use History",
            //                         "free":true,
            //                         "type":"levelFour   "
            //                     }
            //             ]
            //             }
            //         ]
            //     },
            //     {
            //         "name": "React Forms",
            //         "free": true,
            //         "type": "levelTwo",
            //         "children": [
            //             {
            //                 "name": "React hook form",
            //                 "free": true,
            //                 "type": "levelThree",
            //             }
            //         ]
            //     },
            //     {
            //         "name": "React State Management",
            //         "free": true,
            //         "type": "levelTwo",
            //         "children": [
            //             {
            //                 "name": "Redux",
            //                 "free": true,
            //                 "type": "levelThree",
            //                 "children": [{
            //                     "name": "Core Redux",
            //                     "free": true,
            //                     "type":"levelFour",
            //                 },
            //                 {
            //                     "name": "Redux Toolkit",
            //                     "free": true,
            //                     "type":"levelFour",
            //                 },
            //                 {
            //                     "name": "zustin",
            //                     "free": true,
            //                     "type":"levelFour",
            //                 }
            //                 ]
            //             },
            //             {
            //                 "name": "Flux",
            //                 "free": true,
            //                 "type":"levelThree",
            //             }
            //         ]
            //     }
            // ]

       
}

var m = [20, 50, 20, 150],
    w = 1280 - m[1] - m[3],
    h = 800 - m[0] - m[2],
    i = 0,
    root;

var tree = d3.layout.tree()
    .size([h, w]);

var diagonal = d3.svg.diagonal()
    .projection(function (d) { return [d.y, d.x]; });

var vis = d3.select("#body").append("svg:svg")
    .attr("width", w + m[1] + m[3])
    .attr("height", h + m[0] + m[2])
    .append("svg:g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

root = json_data;
root.x0 = h / 2;
root.y0 = 0;

// function toggleAll(d) {
//     if (d.children) {
//         d.children.forEach(toggleAll);
//         toggle(d);
//     }
// }

// it will open open 1level of nodes 

root.children.forEach(function (child) {
    if (child.children) {
        child.children.forEach(function (d, i) {
            console.log(i)
            if (d.children) {
                d._children = d.children;

                // d.children = null;


            }
        });
    }
});
// Initialize the display to show a few nodes.
// root.children.forEach(toggleAll);
// toggle(root.children[1]);
// toggle(root.children[1].children[2]);
// toggle(root.children[9]);
// toggle(root.children[9].children[0]);

update(root);


function update(source) {
    var duration = d3.event && d3.event.altKey ? 5000 : 500;

    // Compute the new tree layout.
    var nodes = tree.nodes(root).reverse();

    // Normalize for fixed-depth.
    nodes.forEach(function (d) { d.y = d.depth * 180; });

    // Update the nodes…
    var node = vis.selectAll("g.node")
        .data(nodes, function (d) { return d.id || (d.id = ++i); });

    // Enter any new nodes at the parent's previous position.
    var nodeEnter = node.enter().append("svg:g")
        .attr("class", "node")
        .attr("transform", function (d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
        .on("click", function (d) { toggle(d); update(d); });

    nodeEnter.append("svg:circle")
        .attr("r", 1e-6)
        .style("fill", function (d) {


            return d._children ? "lightsteelblue" : "#fff";


        });

    nodeEnter.append('a')
        .attr('xlink:href', function (d) {
            return d.url;
        })
        .append("svg:text")
        .attr("x", function (d) { return d.children || d._children ? -10 : 10; })
        .attr("dy", ".35em")
        .attr("text-anchor", function (d) { return d.children || d._children ? "end" : "start"; })
        .text(function (d) { return d.name; })
        .style('fill', function (d) {
            return d.free ? 'black' : '#999';
        })
        .style("fill-opacity", 1e-6);

    nodeEnter.append("svg:title")
        .text(function (d) {
            return d.description;
        });

    // Transition nodes to their new position.
    var nodeUpdate = node.transition()
        .duration(duration)
        .attr("transform", function (d) { return "translate(" + d.y + "," + d.x + ")"; });

    nodeUpdate.select("circle")
        .attr("r", 8)
        .style("fill", function (d) {

            if (d.type == "levelOne") {
                return "#ac4b39"
            }
            else if (d.type == "levelTwo") {
                return "lightsteelblue"
            }
            else if (d.type == "levelThree") {
                return "#00897b"

            }
            else if (d.type == "levelFour") {
                return "#bf447a"
            }
            else if (d.type == "levelFive") {
                return "#bf447a"
            }
            else {
                return "#455a64"
            }
            // return d._children ? "lightsteelblue" : "";

        });

    nodeUpdate.select("text")
        .style("fill-opacity", 1);

    // Transition exiting nodes to the parent's new position.
    var nodeExit = node.exit().transition()
        .duration(duration)
        .attr("transform", function (d) { return "translate(" + source.y + "," + source.x + ")"; })
        .remove();

    nodeExit.select("circle")
        .attr("r", 1e-6);

    nodeExit.select("text")
        .style("fill-opacity", 1e-6);

    // Update the links…
    var link = vis.selectAll("path.link")
        .data(tree.links(nodes), function (d) { return d.target.id; });

    // Enter any new links at the parent's previous position.
    link.enter().insert("svg:path", "g")
        .attr("class", "link")
        .attr("d", function (d) {
            var o = { x: source.x0, y: source.y0 };
            return diagonal({ source: o, target: o });
        })
        .transition()
        .duration(duration)
        .attr("d", diagonal);

    // Transition links to their new position.
    link.transition()
        .duration(duration)
        .attr("d", diagonal);

    // Transition exiting nodes to the parent's new position.
    link.exit().transition()
        .duration(duration)
        .attr("d", function (d) {
            var o = { x: source.x, y: source.y };
            return diagonal({ source: o, target: o });
        })
        .remove();

    // Stash the old positions for transition.
    nodes.forEach(function (d) {
        d.x0 = d.x;
        d.y0 = d.y;
    });
}

// Toggle children.
function toggle(d) {
    if (d.children) {
        d._children = d.children;
        d.children = null;
    } else {
        d.children = d._children;
        d._children = null;
    }
}

// function collapse(d) {
//     if (d.children) {
//         d._children = d.children;
//         d._children.forEach(collapse);
//         d.children = null;
//     }
// }

// Define the click function
function click(d) {
    if (d.children) {
        d._children = d.children;
        d.children = null;
    } else {
        d.children = d._children;
        d._children = null;
        if (d.depth < 2 && d._children) { // Open next level only if depth is less than 2
            d._children.forEach(collapse);
        }
    }
    // update(d);
}

// Define a function to collapse nodes
function collapse(d) {
    if (d.children) {
        d._children = d.children;
        d._children.forEach(collapse);
        d.children = null;
    }
}